<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <script src="./tema.js" defer></script>
  <title>Editar Churrasco</title>

  <script>
    async function loadData() {
      let mySearchParams = new URLSearchParams(document.location.search);
      let idChurrasco = mySearchParams.get("id");

      let data = await fetch("http://localhost:3000/churrascos/${idChurrasco}");
      let churrasco = await data.json();

      document.querySelector("input#idChurrasco").value = idChurrasco;
      document.querySelector("input#data").value = churrasco.dataChurrasco;
      document.querySelector("input#homens").value = churrasco.quantidadeHomens;
      document.querySelector("input#mulheres").value = churrasco.quantidadeMulheres;
      document.querySelector("input#criancas").value = churrasco.quantidadeCriancas;
    }

    window.onload = loadData;
  </script>
</head>

<body class="body">
  <header>
    <p><strong>Tema escuro: </strong></p>
    <div class="container">      
      <div class="btn"></div>
    </div>
  </header>

  <main>
    <section class="textoInical">
      <h1 class="titulo">Churrascômetro</h1>
      <div class="textoApresentacao">
        <p>Precisa de uma ajudinha com o churrasco? :)</p>
        <br>
        <p>Quantas pessoas vão participar?</p>
      </div>
      
    </section>
    <form id="formularioEditar" action="index.html">

        <input type="hidden" id="idChurrasco" />
                

      <div class="input">
        <label for="data"><strong>Data do Churrasco:</strong></label>
        <input id="data" type="date"><br>
      </div>
      
      <div class="input">
        <label for="homens"><strong>Quantidade de Homens:</strong></label>
        <input id="homens" type="number"><br>
      </div>

      <div class="input">
        <label for="mulheres"><strong>Quantidade de Mulheres:</strong></label>
        <input id="mulheres" type="number"><br>
      </div>
      
      <div class="input">
        <label for="criancas"><strong>Quantidade de Crianças:</strong></label>
        <input id="criancas" type="number"><br>
      </div>
      
    </form>

    <div class="btn-editar">
      <button onclick="editarChurrasco()"><strong>Calcular</strong></button>
    </div>
    
  </main>

  

  <script>

    const inputData = document.getElementById('data')
    const inputHomens = document.getElementById('homens')
    const inputMulheres = document.getElementById('mulheres')
    const inputCriancas = document.getElementById('criancas')

    function editarChurrasco() {
      const data = {
        dataChurrasco: inputData.value,
        quantidadeHomens: inputHomens.value,
        quantidadeMulheres: inputMulheres.value,
        quantidadeCriancas: inputCriancas.value,
        quantidadePessoas: Number(inputHomens.value) + Number(inputMulheres.value) + Number(inputCriancas.value),
        quantidadeCarne: Number(inputHomens.value) * 0.4 + Number(inputMulheres.value) * 0.32 + Number(inputCriancas.value) * 0.2,
        quantidadePaoAlho: Number(inputHomens.value) * 2 + Number(inputMulheres.value) * 2 + Number(inputCriancas.value),
        quantidadeCarvao: Number(inputHomens.value) + Number(inputMulheres.value) + Number(inputCriancas.value),
        quantidadeRefri: 2 * (Number(inputHomens.value) + Number(inputMulheres.value) + Number(inputCriancas.value)) / 5,
        quantidadeCerveja: 3 * 600 * (Number(inputHomens.value) + Number(inputMulheres.value)) / 1000
      }

      idChurrasco = document.querySelector("input#idChurrasco").value;

      fetch("http://localhost:3000/churrascos/${idChurrasco}", {
        method: 'PUT',
        body: JSON.stringify(data)
      });

      window.location.href = "index.html";

    }

  </script>

</body>



</html>
